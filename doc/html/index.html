<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Behavioral Architecture: Behavioral-Architecture</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Behavioral Architecture
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Behavioral-Architecture </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>ROS architecture for simulating a robot into a discrete 2D enviroment. The robot has 3 behaviors:</p><ul>
<li>Play</li>
<li>Sleep</li>
<li>Normal</li>
</ul>
<p>The user can interact with the robot via command and pointed gestures </p>
<h1><a class="anchor" id="autotoc_md1"></a>
Software architecture and states diagrams</h1>
<h2><a class="anchor" id="autotoc_md2"></a>
Software architecture</h2>
<p>The architercture is composed by 4 components:</p>
<ul>
<li>Command: simulate user vocal command</li>
<li>Gesture: simulate user pointed gestures</li>
<li>Motion: simulate robot motion</li>
<li>Command manager: implement robot behaviors through a FSM</li>
</ul>
<p><img src="./images/Behavioral_Architecture.jpg" alt="" class="inline"/> </p>
<h2><a class="anchor" id="autotoc_md3"></a>
State diagram</h2>
<p>The finite state machine is composed by 3 state (robot behaviors):</p>
<ul>
<li>PLAY: robot moves from person position to pointed gestures and viceversa</li>
<li>NORMAL (initial state): robot moves in a random ways</li>
<li>SLEEP: robot goes to home position, it stays there for a certain time and then goes to NORMAL state</li>
</ul>
<p><img src="./images/Behavioral_Architecture_FSM.jpg" alt="" class="inline"/> </p>
<h2><a class="anchor" id="autotoc_md4"></a>
ROS messages and parameters</h2>
<p>The messages are:</p>
<ul>
<li><code>Point</code>: 2D position used for pointed gestures and target position</li>
<li><code>String</code>: used for user command and feedback from "motion" component</li>
</ul>
<p>The parameters are:</p>
<ul>
<li><code>home_pos_x,home_pos_x</code>: define the home position in the map (double)</li>
<li><code>person_pos_x,person_pos_y</code>: define the person position in the map (double)</li>
<li><code>map_x,map_y</code>: define the dimensions of the map (integer)</li>
<li><code>min_delay_command,max_delay_command</code>: define the min and max delay for sending the command "play" (double)</li>
<li><code>min_delay_gesture,max_delay_gesture</code>: define the min and max delay for sending the pointed gesture (double)</li>
<li><code>min_delay_robot_motion,max_delay_robot_motion</code>: define the min and max delay for simulating the robot motion (double)</li>
<li><code>min_transition_play_normal,max_transition_play_normal</code>: define the min and max delay to trasit between PLAY and NORMAL (integer)</li>
<li><code>min_transition_normal_sleep,max_transition_normal_sleep</code>: define the min and max delay to trasit between NORMAL and SLEEP (integer)</li>
<li><code>min_sleep_delay,max_sleep_delay</code>: define the min and max delay for the SLEEP state (double)</li>
</ul>
<h1><a class="anchor" id="autotoc_md5"></a>
Packages and files</h1>
<p>There are 3 packages:</p>
<ul>
<li><code>Sensoring</code>: contains the <a href="sensoring/src/command.py">command.py</a> and <a href="sensoring/src/gesture.py">gesture.py</a> files used to simulate the user command and pointed gestures</li>
<li><code>Robot control</code>: contains the <a href="robot_control/src/motion.py">motion.py</a> file used to simulate robot motion</li>
<li><code>Command manager</code>: contains the <a href="manager/src/command_manager">command_manager.py</a> file that implements the FSM of robot behaviors.</li>
</ul>
<h1><a class="anchor" id="autotoc_md6"></a>
Installation and running</h1>
<p>In order to run this software, the following prerequisities are needed:</p><ul>
<li><a href="http://wiki.ros.org/noetic">ROS Noetic</a></li>
<li><a href="http://wiki.ros.org/smach">smach</a></li>
</ul>
<p>Before running the software, you must have all files as executable otherwise you can make them executable with the following command </p><div class="fragment"><div class="line">cd &lt;your_workspace&gt;/src/Behavioral-Architecture</div>
<div class="line">chmod +x sensoring/src/*</div>
<div class="line">chmod +x robot_control/src/*</div>
<div class="line">chmod +x manager/src/*</div>
</div><!-- fragment --><p>To run the software </p><div class="fragment"><div class="line">cd &lt;your_workspace&gt;</div>
<div class="line">catkin_make</div>
<div class="line">source devel/setup.bash</div>
<div class="line">cd src/Behavioral-Architecture</div>
<div class="line">roslaunch launch_file.launch</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md7"></a>
Working hypothesis and environment</h1>
<p>The robot interact with a human via a command and pointed gestures. It moves inside a 2D discrete enviroment. Both robot targets position and pointed gestures belongs to the map. The robot has 3 behaviors: Play,Normal,Sleep. The robot can receive any command while executing PLAY state and it can receive any command or pointed gesture while executing SLEEP state but all of them are ignored while executing one of the two states. The initial state is NORMAL. The only command is "play". There two predifined positions inside the map ("Person" and "Home" position) that cannot be changed during the execution. When the robot moves, it cannot respond to other stimulus. The robot can go into Person or "Home" position during NORMAL behavior and it can go into Home position during PLAY state.</p>
<h1><a class="anchor" id="autotoc_md8"></a>
System's features</h1>
<ul>
<li>Specify different dimensions of the map</li>
<li>It is possibile to define different delays for the simulation</li>
<li>Define different position of the person and the "home" inside the map before start the simulation</li>
<li>It is possible to visualize the states transition in the shell</li>
<li>The robot will notify if it will reach the target position and it is possibile to visualize it in the shell (the position that the robot has reached)</li>
<li>It is not possibile to generate a pointed gesture equal to the person position</li>
</ul>
<h1><a class="anchor" id="autotoc_md9"></a>
System's limitations</h1>
<ul>
<li>There is no graphical interface to view the map and the movement of the robot within it</li>
<li>Commmand, pointed gesture and robot motion are simulated</li>
<li>There isn't check if the user puts a position for the person or the "home" outside the map</li>
<li>Since it is used ROS Noetic, the state transition visualization is limited to the shell (it is necessary to fix some files in order to use smach viewer)</li>
</ul>
<h1><a class="anchor" id="autotoc_md10"></a>
Possible technical improvements</h1>
<ul>
<li>Add other behaviors to the robot</li>
<li>Use a graphical interface for viewing the simulation</li>
<li>Add error handling in order to prevent some user position outside the map</li>
<li>Implemente a real robot motion control</li>
<li>Implements a user interface for the command and pointed gestures</li>
<li>Add more commands</li>
<li>Prevent the robot from going into "unauthorized" positions during some behaviors</li>
</ul>
<h1><a class="anchor" id="autotoc_md11"></a>
Author and contact</h1>
<p><a href="https://github.com/Cavalletta98">Simone Voto</a> - <a href="#" onclick="location.href='mai'+'lto:'+'sim'+'on'+'e.v'+'ot'+'o98'+'@g'+'mai'+'l.'+'com'; return false;">simon<span style="display: none;">.nosp@m.</span>e.vo<span style="display: none;">.nosp@m.</span>to98@<span style="display: none;">.nosp@m.</span>gmai<span style="display: none;">.nosp@m.</span>l.com</a> </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
